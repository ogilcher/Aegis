name: iOS CI

on:
    pull_requests:
    push:
        branches: [ "main" ]
        
concurrency:
    group: ios-ci-${{ github.ref }}
    cancel-in-progress: true
    
jobs:
    build-and-test:
        runs-on: macos-15
        timeout-minutes: 30
        
        steps:
            - name: Checkout
              uses: actions/checkout@v4
              
            - name: build
            run: |
                xcodebuild \
                    -project ios/Aegis.xcodeproj \
                    -scheme Aegis \
                    -sdk iphonesimulator \
                    -destination 'platform=iOS Simulator,name=iPhone 15,OS=latest' \
                    -configuration Debug \
                    build
                    
            - name: Test
            run: |
                xcodebuild \
                    -project ios/Aegis.xcodeproj \
                    -scheme Aegis \
                    -sdk iphonesimulator \
                    -destination 'platform=iOS Simulator,name=iPhone 15,OS=latest' \
                    test
                    
              
            
